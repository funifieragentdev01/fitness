<div id="plans" class="screen has-nav">
    <div class="screen-header">
        <button class="btn-back" ng-click="goTo('profile')"><i class="fas fa-arrow-left"></i></button>
        <h2>Planos</h2>
    </div>
    <div class="screen-body">
        <div class="alert alert-success" ng-if="success">{{success}}</div>
        <div class="alert alert-danger" ng-if="error">{{error}}</div>

        <div class="sandbox-badge" ng-if="envLabel">
            <span>{{envLabel}}</span>
        </div>

        <!-- Coupon Section -->
        <div class="coupon-section">
            <div class="coupon-input-row">
                <input type="text" class="coupon-input" ng-model="couponCode"
                       placeholder="Tem um cupom? Digite aqui"
                       ng-disabled="couponValid"
                       ng-keyup="$event.keyCode === 13 && validateCoupon()">
                <button class="btn btn-sm coupon-btn" ng-click="validateCoupon()"
                        ng-if="!couponValid" ng-disabled="checkingCoupon || !couponCode">
                    {{checkingCoupon ? '...' : 'Aplicar'}}
                </button>
                <button class="btn btn-sm coupon-btn-clear" ng-click="clearCoupon()" ng-if="couponValid">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="coupon-result coupon-success" ng-if="couponValid">
                <i class="fas fa-check-circle"></i> {{couponInfo.description}}
            </div>
            <div class="coupon-result coupon-error" ng-if="couponValid === false">
                <i class="fas fa-times-circle"></i> {{couponError}}
            </div>
        </div>

        <div class="plans-container">
            <!-- Standard Card -->
            <div class="plan-card" ng-class="{'plan-active': !isPremium}">
                <div class="plan-badge" ng-if="!isPremium">Plano Atual</div>
                <div class="plan-header">
                    <h3>‚≠ê Standard</h3>
                    <div class="plan-price">
                        <span class="price-old" ng-if="hasDiscount('standard')">R$ {{getOriginalPrice('standard') | number:2}}</span>
                        <span class="price-value">R$ {{getPrice('standard') | number:2}}</span>
                        <span class="price-period">/m√™s</span>
                    </div>
                </div>
                <ul class="plan-features">
                    <li><i class="fas fa-check"></i> Plano alimentar personalizado por IA</li>
                    <li><i class="fas fa-check"></i> Plano de treino personalizado por IA</li>
                    <li><i class="fas fa-check"></i> 1 altera√ß√£o de plano por m√™s</li>
                    <li><i class="fas fa-check"></i> 1 check-in corporal por m√™s</li>
                    <li><i class="fas fa-check"></i> 1 an√°lise de laudo por m√™s</li>
                    <li><i class="fas fa-check"></i> Controle de √°gua e refei√ß√µes</li>
                    <li><i class="fas fa-check"></i> Desafio 90 Dias</li>
                    <li class="feature-disabled"><i class="fas fa-times"></i> Coach IA 24/7</li>
                    <li class="feature-disabled"><i class="fas fa-times"></i> Suporte priorit√°rio</li>
                </ul>
                <button class="btn btn-block btn-primary" ng-click="selectPlan('standard')" ng-disabled="loading">
                    {{loading ? 'Processando...' : 'Assinar Standard ‚≠ê'}}
                </button>
            </div>

            <!-- Premium Card -->
            <div class="plan-card plan-premium" ng-class="{'plan-active': isPremium}">
                <div class="plan-badge premium-badge" ng-if="isPremium">Plano Atual üëë</div>
                <div class="plan-badge premium-badge" ng-if="!isPremium">Recomendado</div>
                <div class="plan-header">
                    <h3>üëë Premium</h3>
                    <div class="plan-price">
                        <span class="price-old" ng-if="hasDiscount('premium')">R$ {{getOriginalPrice('premium') | number:2}}</span>
                        <span class="price-value premium-price">R$ {{getPrice('premium') | number:2}}</span>
                        <span class="price-period">/m√™s</span>
                    </div>
                </div>
                <ul class="plan-features">
                    <li><i class="fas fa-check"></i> Tudo do Standard, mais:</li>
                    <li><i class="fas fa-check"></i> Altera√ß√µes <strong>ilimitadas</strong> de planos</li>
                    <li><i class="fas fa-check"></i> Check-ins corporais <strong>ilimitados</strong></li>
                    <li><i class="fas fa-check"></i> An√°lises de laudos <strong>ilimitadas</strong></li>
                    <li><i class="fas fa-check"></i> Coach IA personalizado 24/7</li>
                    <li><i class="fas fa-check"></i> Suporte priorit√°rio</li>
                </ul>
                <button class="btn btn-block btn-primary btn-premium" ng-click="selectPlan('premium')" ng-disabled="isPremium || loading">
                    {{isPremium ? 'Plano Atual üëë' : (loading ? 'Processando...' : 'Assinar Premium üëë')}}
                </button>
            </div>
        </div>

        <div class="plans-payment-info">
            <p><i class="fas fa-shield-alt"></i> Pagamento seguro via Asaas</p>
            <p><i class="fab fa-pix"></i> Pix ‚Ä¢ <i class="fas fa-credit-card"></i> Cart√£o ‚Ä¢ <i class="fas fa-barcode"></i> Boleto</p>
        </div>

        <p class="plans-footer">7 dias gr√°tis ‚Ä¢ Cancele quando quiser</p>
    </div>
    <bottom-nav active="'profile'"></bottom-nav>
</div>
