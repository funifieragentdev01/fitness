<div id="body-checkin" class="screen">
    <div class="screen-header">
        <button class="btn-back" ng-click="goTo('profile')"><i class="fas fa-arrow-left"></i></button>
        <h2>ðŸ“¸ Check-in Corporal</h2>
    </div>
    <div class="screen-body">
        <div class="form-group">
            <label>Peso atual (kg)</label>
            <input type="number" ng-model="checkin.weight" placeholder="Ex: 78.5" step="0.1" min="30" max="300">
        </div>
        <div class="form-group">
            <label>Fotos corporais (opcional)</label>
            <div class="body-photos-grid">
                <div class="body-photo-box">
                    <label>Frente</label>
                    <div class="photo-upload-area small" ng-click="triggerCheckinPhoto('front')">
                        <img ng-if="checkin.photo_front" ng-src="{{checkin.photo_front}}" class="meal-preview">
                        <div ng-if="!checkin.photo_front" class="photo-placeholder">
                            <i class="fas fa-person fa-2x"></i>
                            <p>Frente</p>
                        </div>
                    </div>
                </div>
                <div class="body-photo-box">
                    <label>Lateral</label>
                    <div class="photo-upload-area small" ng-click="triggerCheckinPhoto('side')">
                        <img ng-if="checkin.photo_side" ng-src="{{checkin.photo_side}}" class="meal-preview">
                        <div ng-if="!checkin.photo_side" class="photo-placeholder">
                            <i class="fas fa-person fa-2x"></i>
                            <p>Lateral</p>
                        </div>
                    </div>
                </div>
            </div>
            <input type="file" id="checkinPhotoFrontInput" accept="image/*" capture="environment" style="display:none" onchange="angular.element(this).scope().onCheckinPhotoType('front', this)">
            <input type="file" id="checkinPhotoSideInput" accept="image/*" capture="environment" style="display:none" onchange="angular.element(this).scope().onCheckinPhotoType('side', this)">
        </div>
        <button class="btn btn-primary btn-block" ng-click="submitCheckin()" ng-disabled="!checkin.weight || loading">
            <span ng-if="!loading">Salvar Check-in ðŸ“¸</span>
            <span ng-if="loading"><i class="fas fa-spinner fa-spin"></i> Salvando...</span>
        </button>
        <button class="btn btn-outline btn-block" ng-if="checkin.photo_front || checkin.photo_side" ng-click="analyzeBodyPhotos(checkin.photo_front, checkin.photo_side)" ng-disabled="bodyAnalysisLoading" style="margin-top:8px">
            ðŸ”¬ Analisar composiÃ§Ã£o corporal
        </button>
        <div class="alert alert-success" ng-if="success">{{success}}</div>
        <div class="progress-section" ng-show="checkinHistory.length" style="margin-top:24px">
            <h3 class="section-title">HistÃ³rico de Check-ins</h3>
            <div class="checkin-history-list">
                <div class="checkin-history-item" ng-repeat="item in checkinHistory">
                    <div class="checkin-history-header">
                        <span class="weight-date">{{item.date}}</span>
                        <span class="weight-value">{{item.weight}} kg</span>
                    </div>
                    <div class="checkin-history-photos" ng-show="item.photo_front_url || item.photo_side_url">
                        <img ng-show="item.photo_front_url" ng-src="{{item.photo_front_url}}" class="checkin-thumb">
                        <img ng-show="item.photo_side_url" ng-src="{{item.photo_side_url}}" class="checkin-thumb">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
